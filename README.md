# Double DIP for crosstalk mitigation in multislice ptychography

This repository is built based on the orignal "Double DIP"
implementation by Gandelsman *et al*.
([http://www.wisdom.weizmann.ac.il/~vision/DoubleDIP/](http://www.wisdom.weizmann.ac.il/~vision/DoubleDIP/)).

To account for the partial-band transfer of features on different slices
when they superimpose, an additional filtering is added to the images
generated by the DIPs. You can choose to use single-layer filters by
setting `blur_type='filter'`, or a 3-layer shallow U-Net by setting
`blur-type='net'`.

![model](/figs/model.png "model")

You may use `zp_separation.py` as a starting point.

```
Suggested paramas: 
(blur) gamma_excl = 0.4
(net) gamma_excl = 0.04 - 0.1
learning_rate = 1e-3
gamma_reg = 0.5
reg_threshold = 100 iters
```
